<page-layout>
  <page-content mode="filters" [heading]="i18n.notification.title"
    [mobileHeading]="i18n.notification.mobileTitle"
    [headingActions]="headingActions$ | async">
    <form [formGroup]="form"
      class="filters-form filters-form-separator border-0">
      <div class="row">
        <div class="col-12 col-md-6">
          <boolean-field labelPosition="sideForced"
            formControlName="onlyUnread"
            [label]="i18n.notification.onlyUnread"></boolean-field>
        </div>
      </div>
    </form>

  </page-content>
  <results-layout resultType="list" [results]="results$ | async"
    (update)="update($event)" [onClick]="onClick" [rendering$]="rendering$">

    <mobile-result *mobileResult="let row"
      [avatarImage]="row.relatedUser?.image" avatarIcon="notifications_none">

      <div class="cell-main" [tooltip]="row.message">{{ row.subject }}</div>
      <div class="cell-cell-date" [tooltip]="row.message">
        {{ row.date | dateTime }}
      </div>

    </mobile-result>

    <table *resultTable class="table table-hover cursor-pointer">
      <thead>
        <th class="avatar"></th>
        <th>{{ i18n.general.date }}</th>
        <th>{{ i18n.notification.message }}</th>
        <th class="actions"></th>
      </thead>
      <tbody>
        <ng-container *ngFor="let row of (results$ | async)?.results">
          <tr (click)="rowClick(row)"
            [ngClass]="{'font-weight-bold': !row.read}">
            <td class="avatar" [ngClass]="{
              'pb-0': layout.xxs$ | async,
              'border-0': layout.xxs$ | async
            }">
              <avatar [image]="row.relatedUser?.image"
                [tooltip]="row.relatedUser?.display"
                icon="notifications_none"></avatar>
            </td>
            <td>{{ row.date | dateTime }}</td>
            <td>{{ row.message }}</td>
            <td class="actions">
              <button [tooltip]="i18n.notification.actions.remove"
                class="btn btn-icon"
                (click)="remove(row); $event.stopPropagation()">
                <icon icon="clear"></icon>
              </button>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </results-layout>
</page-layout>
