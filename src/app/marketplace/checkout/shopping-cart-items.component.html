<results-layout [results]="items" resultType="list"
  [toLink]="detailed ? toLink : null">
  <mobile-result *mobileResult="let row" [avatarImage]="row.product.image"
    avatarIcon="shopping_basket" [title]="row.product.name">
    <div class="d-flex">
      <div>
        <div class="cell-text">
          {{ i18n.transaction.amount }}:
          {{ row.totalPrice | currency:currency }}
        </div>
        <div class="cell-text">
          {{ i18n.ad.number }}: {{ row.product.productNumber }}
        </div>
        <div class="cell-text">
          {{ i18n.ad.unitPrice }}:
          {{ row.price | currency: currency}}
        </div>
        <div class="cell-text">
          {{ i18n.ad.quantity }}: {{ resolveQuantityLabel(row) }}
        </div>
      </div>
      <div *ngIf="detailed" class="ml-auto text-right d-flex flex-column">
        <button [tooltip]="i18n.ad.changeQuantity" class="btn btn-icon"
          (click)="changeQuantity.emit([null, row, false]); $event.stopPropagation(); $event.preventDefault()">
          <icon icon="edit"></icon>
        </button>
        <button [tooltip]="i18n.general.remove" class="btn btn-icon mt-2"
          (click)="remove.emit(row); $event.stopPropagation(); $event.preventDefault()">
          <icon icon="clear"></icon>
        </button>
      </div>
    </div>
  </mobile-result>

  <table *resultTable class="table table-hover cursor-pointer">
    <thead>
      <th class="avatar"></th>
      <th width="30%">{{ i18n.ad.product }}</th>
      <th>{{ i18n.ad.number }}</th>
      <th width="15%">{{ i18n.ad.quantity }}</th>
      <th class="text-right">{{ i18n.ad.unitPrice }}</th>
      <th class="text-right">{{ i18n.transaction.amount }}</th>
      <th *ngIf="detailed" class="actions"></th>
    </thead>
    <tbody>
      <tr *ngFor="let row of items">
        <td class=" avatar" [ngClass]="{
              'pb-0': layout.xxs$ | async,
              'border-0': layout.xxs$ | async
            }">
          <avatar [image]="row.product.image" [tooltip]="row.product.name"
            icon="shopping_basket"></avatar>
        <td [ngClass]="{'link' : detailed}"
          [ngStyle]="{'text-decoration': !isAvailable(row) ? 'line-through' : ''}">
          <span (click)="navigate(row)">{{ row.product.name }}</span>
        </td>
        <td>{{ row.product.productNumber }}</td>
        <td>
          <form *ngIf="useForm(layout.gtsm$ | async)" [formGroup]="form">
            <decimal-field *ngIf="isAvailable(row)" [formControlName]="row.id"
              [scale]="row.product.allowDecimalQuantity ? 2 : 0">
            </decimal-field>
          </form>
          <ng-container *ngIf="!useForm(layout.gtsm$ | async)">
            {{ resolveQuantityLabel(row) }}
          </ng-container>
        </td>
        <td class="text-right">
          {{ row.price | currency: currency }}
        </td>
        <td class="text-right">
          {{ row.totalPrice | currency: currency }}</td>
        <td *ngIf="detailed" class="actions actions-multiple">
          <button *ngIf="!useForm(layout.gtsm$ | async) && isAvailable(row)"
            [tooltip]="i18n.ad.changeQuantity" class="btn btn-icon"
            (click)="changeQuantity.emit([null, row, false]); $event.stopPropagation()">
            <icon icon="edit"></icon>
          </button>
          <button [tooltip]="i18n.general.remove" class="btn btn-icon"
            [ngClass]="{'ml-3' : !useForm(layout.gtsm$ | async) && isAvailable(row)}"
            (click)="remove.emit(row); $event.stopPropagation()">
            <icon icon="clear"></icon>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</results-layout>
